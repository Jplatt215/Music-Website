{% extends "base.html" %}

{% block title %}Music Index{% endblock %}

{% block content %}
<head>
  <!-- Link to the stylesheet -->
  <link rel="stylesheet" href="{{ url_for('static', filename='composer.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='global.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/tone@14.8.39/build/Tone.min.js"></script>
  <script src="{{ url_for('static', filename='composer.js') }}" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/vexflow@4.2.2/build/cjs/vexflow.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tonejs/midi"></script>

  <title>Automated Composition</title>
</head>
<body>
  <div class="navbar-main">
    <a class="nav-item nav-link" id="index" href="/index">Music Index</a>
    <a class="nav-item nav-link" id="scales" href="/scales">Scale Calculator</a>
    <a class="nav-item nav-link" id="composer" href="/composer">Automated Composition</a>
  </div>
  <div class="header">
    <div class="menu">
      <!-- Tabs -->
      <div class="tabs">
        <button class="tab-btn active" data-target="input-menu">Create</button>
        <button class="tab-btn" data-target="settings-menu">Settings</button>
      </div>

      <!-- Input Menu -->
      <div id="input-menu" class="tab-content">
        <div class="buttonDescription">Generate</div>
        <div class="row">
          <div style="flex: 1;">
            <button class="generatePhraseButton" style="width: 100%;">Phrase</button>
          </div>
        </div>

        <div class="buttonDescription">Accompany</div>
        <div class="row">
          <div style="flex: 1;">
            <button class="separateVoiceButton" style="width: 100%;">Separate</button>
          </div>
        </div>

        <div class="buttonDescription">Modify</div>
        <div class="row" style="gap: 0;"> 
          <div style="flex: 1;">
            <button class="reverseButton" style="width: 100%;">Reverse</button>
          </div>
          <!-- Reflect -->
          <div style="flex: 1; position: relative; overflow: visible;">
            <button class="reflectButton" style="width: 100%;">Reflect</button>
            <select id="reflectSelect" size="8" style="display:none; position: absolute; top: 100%; left: 0; width: 100%; z-index: 9999;">
              <option value="A">A</option>
              <option value="Bb">Bb</option>
              <option value="B" selected>B</option>
              <option value="C">C</option>
              <option value="Db">Db</option>
              <option value="D">D</option>
              <option value="Eb">Eb</option>
              <option value="E">E</option>
              <option value="F">F</option>
              <option value="Gb">Gb</option>
              <option value="G">G</option>
              <option value="Ab">Ab</option>
            </select>
          </div>
        </div>

        <div class="row" style="gap: 0;"> 
          <!-- Shift -->
          <div style="flex: 1; position: relative; overflow: visible;">
            <button class="shiftButton" style="width: 100%;">Shift</button>
            <select id="shiftSelect" size="8" style="display:none; position: absolute; top: 100%; left: 0; width: 100%; z-index: 9999;">
              <option value="w">ùÖù</option>
              <option value="hd" selected>ùÖû.</option>
              <option value="h">ùÖû</option>
              <option value="qd">ùÖü.</option>
              <option value="q">ùÖü</option>
              <option value="8d">ùÖ†.</option>
              <option value="8">ùÖ†</option>
              <option value="16d">ùÖ°.</option>
              <option value="16">ùÖ°</option>
              <option value="32">ùÖ¢</option>
            </select>
          </div>
          <!-- Transpose -->
          <div style="flex: 1; position: relative; overflow: visible;">
            <button class="transposeButton" id="transposeButton" style="width: 100%;">Transpose</button>
            <select id="transposeDropdown" size="8" style="display:none; position: absolute; top: 100%; left: 0; width: 100%; z-index: 9999;">
            </select>
          </div>
        </div>

        <div class="row">
          <div style="flex: 1;"><button class="shuffleRhythmButton" style="width: 100%;">Shuffle Rhythm</button></div>
          <div style="flex: 1;"><button class="shuffleNotesButton" style="width: 100%;">Shuffle Notes</button></div>
          <div style="flex: 1;"><button class="shufflePitchButton" style="width: 100%;">Shuffle Pitch</button></div>
        </div>

        <div class="row">
          <div style="flex: 1;"><button class="changeRhythmButton" style="width: 100%;">Change Rhythm</button></div>
          <div style="flex: 1;"><button class="changePitchButton" style="width: 100%;">Change Pitch</button></div>
        </div>

        <div class="buttonDescription">Develop</div>
        <div class="row">
          <div style="flex: 1;"><button class="simplifyButton" style="width: 100%;">Simplify</button></div>
          <div style="flex: 1;"><button class="complicateButton" style="width: 100%;">Complicate</button></div>
        </div>

        <div class="buttonDescription">Play</div>
        <div class="row">
          <button id="bpmDisplay">Tempo: <span id="bpmValue">120</span> BPM
            <input type="range" id="bpmSlider" min="30" max="180" value="120" />
          </button>
        </div>
        <div class="row"><button class="playButton">‚èµ</button></div>

        <div class="buttonDescription">Copy</div>
        <div class="row">
          <button class="copyPartButton">Copy</button>
          <button class="pastePartButton">Paste</button>
        </div>

        <div class="buttonDescription">Select</div>
        <div class="row">
          <button class="previousButton">‚Üê</button>
          <button class="nextButton">‚Üí</button>
        </div>
      </div>

      <!-- Settings Menu -->
      <div id="settings-menu" class="tab-content hidden">
        <div class="row">
            <div class="row">
                <div class="buttonDescription">Time Signature</div>
                    <select id="timeSignatureTop">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4" selected>4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                    </select>
                    <!-- Bottom dropdown -->
                    <select id="timeSignatureBottom">
                        <option value="4" selected>4</option>
                        <option value="8">8</option>
                        <option value="16">16</option>
                    </select>
                </div>
            <div class="row">
                <div class="buttonDescription"># Measures</div>
                <select id="numMeasuresSelect">
                    <option value="1"selected>1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                </select>
            </div>
            </div>
            <div class="row">
                <div class="buttonDescription">Mode</div>
                <select id="modeSelect">
                    <option value="Standard" selected>Standard</option>
                    <option value="Harmony">Harmony</option>
                </select>
            </div>
            <div id="harmonyVoiceContainer" class="voiceContainer" data-name="harmonyVoice"></div>
            <button class="randomHarmonyButton" style="width: 100%">‚§Æ</button>
            <button class="chordPlayButton" style="width: 100%">‚èµ</button>
        </div>
    </div>
        
    
    <!-- Output -->
<div class="output-container">
  <div id="output"></div>
</div>

<template id="voiceTemplate">
  <div class="voiceWrapper">
    <div class="voiceSettings">
      <div class="row">
        <select class="rootSelect">
          <option value="A">A</option>
          <option value="Bb">Bb</option>
          <option value="B">B</option>
          <option value="C" selected>C</option>
          <option value="Db">Db</option>
          <option value="D">D</option>
          <option value="Eb">Eb</option>
          <option value="E">E</option>
          <option value="F">F</option>
          <option value="Gb">Gb</option>
          <option value="G">G</option>
          <option value="Ab">Ab</option>
        </select>
        <div class="row">
          <select class="scaleSelect"></select>
        </div>
      </div>
      <div class="row">
        <select class="minPitch"></select> - <select class="maxPitch"></select>
      </div>
      <div class="row">
        <select class="minRhythm"></select> - <select class="maxRhythm"></select>
      </div>
      <select class="instrumentSelect">
        <option value="Winds">Winds</option>
        <option value="Brass">Brass</option>
        <option value="Piano" selected>Piano</option>
        <option value="Strings">Strings</option>
      </select>
      <div class="row">
        <button class="muteButton">Mute</button>
      </div>
      <div style="height:100px;"></div>
      <div class="row">
        <button class="midiButton">MIDI</button>
        <button class="musicXMLButton">MusicXML</button>
      </div>
    </div>
    <div class="voiceContainer"></div>
  </div>
</template>

  </div>
</body>
{% endblock %}
